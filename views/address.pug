extends layout

block content
  .row
    .col-xl-3.col-lg-3.col-md-3.col-sm-3.grid-margin.stretch-card
      .card.card-statistics(style="height: 100%;")
        .card-body
          .clearfix
            p Repositories
            if (repositories.length)
              ul
                each repository, index in repositories
                  li
                    a(href='/repositories/' + repository.hex)#repositoryName #{repository.name}
                      span.line(style="display: inline-block;")
                      span.line(style="display: inline-block;")
            else
              p.text-muted This contributor has not yet contributed to any repositories.
    .col-xl-6.col-lg-6.col-md-6.col-sm-6.grid-margin
      .card(style="height: 100%;")
        .card-body
          .row.text-center
            .col-12.mb-2
                - var generateIdenticon = function(eth_address){  
                -   var data = new identicon(eth_address).toString();
                -   return 'data:image/png;base64,' + data;
                - }
                if twitter
                  img.img-xl.rounded-circle(src='https://twitter.com/' + twitter + '/profile_image?size=bigger', alt='Twitter profile picture')
                else
                  img.img-xl.rounded-circle(src='' + generateIdenticon(address), alt='User identicon')
            .col-12
              h1
                if twitter 
                  a(href='https://twitter.com/' + twitter target="_blank") #{twitter}
                else
                  span Contributor
              p.text-muted #{address}
          if (Object.entries(balance).length === 0 && balance.constructor === Object)
            blockquote.blockquote This contributor has not yet earned any knowledge tokens.
    .col-xl-3.col-lg-3.col-md-3.col-sm-3.grid-margin.stretch-card
      .card.card-statistics(style="height: 100%;")
        .card-body
          .clearfix
            .float-right
              p.mb-0.text-right Balance
              .fluid-container
                h3.font-weight-medium.text-right.mb-4 #{xDAIBalance} xDAI
                h3.font-weight-medium.text-right.mb-4 #{xDitBalance} xDIT
                h3.font-weight-medium.text-right #{total} KNW
  if !(Object.entries(balance).length === 0 && balance.constructor === Object)
    .row
      .col-12.grid-margin
        .card
          .card-body
            h4.card-title KNW Tokens
            .table-responsive
              table.table.table-hover
                thead
                  tr
                    th Label
                    th
                    th.text-right Amount
                tbody
                each val, index in balance
                  tr
                    td= index
                    td(style="width: 50%;")
                      .progress
                        .progress-bar.progress-bar-striped(role='progressbar', style='width: ' + (val/total)*100 + '%', aria-valuenow='' + (val/total)*100, aria-valuemin='0', aria-valuemax='100')
                    td.font-weight-bold.text-right= val
  if (proposals.length)
    .row
      .col-12.grid-margin
        .card
          .card-body
            h5.card-title.mb-4 Proposals
            .fluid-container
              include ./comp-proposals.pug
  script.
    var fields = $('#repositoryName').text().split('/');
    $('span.line:nth-child(1)').text(fields[0]);
    $('span.line:nth-child(2)').text('/' + fields[1]);

    $("#repositoryName").contents().filter(function(){
        return (this.nodeType == 3);
    }).remove();